<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>r/JEENEEtards</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        /* --color-green: #4caf50; */
        /* --0color-light-green: #81c784; */
        --color-blue: #007ea7;
        --color-light-blue: #80ced7;
        --color-yellow: #ffeb3b;
        --color-orange: #ff9800;
        --color-red: #f44336;
        --color-light-red: #ef9a9a;
        --text-color: #333333;
        --background-color: #f4f4f4;
        --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      body {
        font-family: "Open Sans", sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
        color: var(--text-color);
        background-color: var(--background-color);
        font-size: 18px;
      }

      h1 {
        font-size: 2.8rem;
        text-align: center;
        border-bottom: 2px solid var(--color-blue);
        padding-bottom: 10px;
        margin-bottom: 30px;
        color: var(--color-blue);
      }

      .table-container {
        overflow-x: auto;
        margin-bottom: 30px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 1.1rem;
        background-color: var(--background-color);
        box-shadow: var(--box-shadow);
      }

      th,
      td {
        border: 1px solid var(--text-color);
        padding: 12px;
        text-align: left;
      }

      th {
        background-color: var(--color-light-blue);
        color: var(--text-color);
        font-weight: 600;
        position: sticky;
        top: 0;
        z-index: 10;
      }

      td {
        background-color: #ffffff;
      }

      input,
      button,
      select {
        margin: 5px 0;
        padding: 12px;
        font-size: 1.1rem;
        border: 1px solid var(--color-light-blue);
        border-radius: 4px;
        width: 100%;
      }

      button {
        background-color: var(--color-blue);
        color: #ffffff;
        cursor: pointer;
        transition: background-color 0.3s;
        border: none;
      }

      button:hover {
        background-color: var(--color-light-blue);
      }

      #notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 20px;
        background-color: var(--color-blue);
        color: #ffffff;
        border-radius: 5px;
        display: none;
        font-size: 1.1rem;
        box-shadow: var(--box-shadow);
        z-index: 20;
      }

      @media (max-width: 600px) {
        body {
          padding: 10px;
        }

        h1 {
          font-size: 2.2rem;
        }

        table,
        th,
        td {
          font-size: 1rem;
        }

        input,
        button,
        select {
          width: 100%;
          margin: 5px 0;
        }
      }

      #chapterForm {
        background-color: var(--color-light-blue);
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 4px;
        box-shadow: var(--box-shadow);
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
      }

      #chapterForm select,
      #chapterForm input {
        flex: 1 1 20%;
        min-width: 150px;
      }

      #chapterForm button {
        flex: 1 1 100%;
        min-width: 150px;
      }

      #quoteSection {
        text-align: center;
        font-style: italic;
        margin: 20px 0;
        font-size: 1.4rem;
        color: var(--text-color);
        background-color: #ffffff;
        padding: 15px;
        border-radius: 4px;
        box-shadow: var(--box-shadow);
      }

      #searchFilter {
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
      }

      #searchFilter input,
      #searchFilter select {
        flex: 1;
        min-width: 200px;
      }

      .progress-bar {
        width: 100%;
        background-color: var(--color-light-blue);
        border-radius: 4px;
        margin-top: 10px;
        overflow: hidden;
      }

      .progress {
        width: 0;
        height: 24px;
        background-color: var(--color-blue);
        border-radius: 4px;
        transition: width 0.5s ease-in-out;
      }
    </style>
  </head>
  <body>
    <h1>r/JEENEEtards</h1>
    <div id="quoteSection"></div>
    <div id="chapterForm">
      <select id="subject">
        <option value="Physics">Physics</option>
        <option value="Chemistry">Chemistry</option>
        <option value="Mathematics">Mathematics</option>
      </select>
      <input type="text" id="chapterName" placeholder="Chapter Name" />
      <input type="date" id="studyDate" />
      <select id="priority">
        <option value="1">High</option>
        <option value="2">Medium</option>
        <option value="3">Low</option>
      </select>
      <button onclick="addChapter()">Add Chapter</button>
    </div>
    <div id="searchFilter">
      <input type="text" id="searchInput" placeholder="Search chapters..." />
      <select id="filterSubject">
        <option value="All">All Subjects</option>
        <option value="Physics">Physics</option>
        <option value="Chemistry">Chemistry</option>
        <option value="Mathematics">Mathematics</option>
      </select>
    </div>
    <div class="table-container">
      <table id="chapterTable">
        <tr>
          <th>Subject</th>
          <th>Chapter</th>
          <th>Last Studied</th>
          <th>Days Since</th>
          <th>Revisions</th>
          <th>Priority</th>
          <th>Action</th>
        </tr>
      </table>
    </div>
    <div id="notification"></div>

    <script>
      function addChapter() {
        const subject = document.getElementById("subject").value;
        const chapterName = document.getElementById("chapterName").value;
        const studyDate = document.getElementById("studyDate").value;
        const priority = document.getElementById("priority").value;

        if (chapterName.length > 50) {
          showNotification(
            "Chapter name is too long. Please keep it under 50 characters."
          );
          return;
        }

        // Adjust for local time zone
        const today = new Date();
        today.setMinutes(today.getMinutes() - today.getTimezoneOffset());
        const localToday = today.toISOString().split("T")[0];

        if (studyDate > localToday) {
          showNotification(
            "Date cannot be in the future. Please select a valid date."
          );
          return;
        }

        if (subject && chapterName && studyDate) {
          let chapters = JSON.parse(localStorage.getItem("chapters")) || {};
          chapters[`${subject}-${chapterName}`] = {
            subject: subject,
            lastStudied: studyDate,
            revisions: 0,
            priority: priority,
          };
          localStorage.setItem("chapters", JSON.stringify(chapters));
          updateTable();
          document.getElementById("chapterName").value = "";
          document.getElementById("studyDate").value = "";
          showNotification("Chapter added successfully!");
          updateProgress();
        }
      }

      function updateTable() {
        const table = document.getElementById("chapterTable");
        const chapters = JSON.parse(localStorage.getItem("chapters")) || {};
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const filterSubject = document.getElementById("filterSubject").value;

        // Clear existing rows
        while (table.rows.length > 1) {
          table.deleteRow(1);
        }

        for (let key in chapters) {
          const chapter = chapters[key];
          if (
            (searchTerm === "" || key.toLowerCase().includes(searchTerm)) &&
            (filterSubject === "All" || chapter.subject === filterSubject)
          ) {
            const row = table.insertRow();
            const cell1 = row.insertCell(0);
            const cell2 = row.insertCell(1);
            const cell3 = row.insertCell(2);
            const cell4 = row.insertCell(3);
            const cell5 = row.insertCell(4);
            const cell6 = row.insertCell(5);
            const cell7 = row.insertCell(6);

            cell1.textContent = chapter.subject;
            cell2.textContent = key.split("-")[1];
            cell3.textContent = chapter.lastStudied;

            const daysSince =
              Math.floor(
                (new Date().getTime() -
                  new Date(chapter.lastStudied).getTime()) /
                  (1000 * 3600 * 24) +
                  1
              ) || 0; // Add 1 to avoid showing -1 days for chapters studied today
            cell4.textContent = daysSince;

            const revisionButton = document.createElement("button");
            revisionButton.textContent = chapter.revisions;
            revisionButton.onclick = () => incrementRevisions(key);
            cell5.appendChild(revisionButton);

            const priorityLevel =
              chapter.priority === "1"
                ? "High"
                : chapter.priority === "2"
                ? "Medium"
                : "Low";
            cell6.textContent = priorityLevel;

            const deleteButton = document.createElement("button");
            deleteButton.textContent = "Delete";
            deleteButton.onclick = () => deleteChapter(key);
            cell7.appendChild(deleteButton);
          }
        }
      }

      function incrementRevisions(key) {
        let chapters = JSON.parse(localStorage.getItem("chapters")) || {};
        chapters[key].revisions++;
        localStorage.setItem("chapters", JSON.stringify(chapters));
        updateTable();
        updateProgress();
      }

      function deleteChapter(key) {
        let chapters = JSON.parse(localStorage.getItem("chapters")) || {};
        delete chapters[key];
        localStorage.setItem("chapters", JSON.stringify(chapters));
        updateTable();
        showNotification("Chapter deleted successfully!");
        updateProgress();
      }

      /*
      function getUrgencyColor(days) {
        // Red to green color scale
        const urgencyScale = [
          "#FFF9C4", // 0 days - very light yellow
          "#FFEB3B", // 1 day - yellow
          "#FFC107", // 2 days - amber
          "#FF9800", // 3 days - orange
          "#FF5722", // 4 days - deep orange
          "#F44336", // 5 days - red
          "#E53935", // 6 days - slightly darker red
          "#C62828", // 7+ days - dark red
        ];
        return urgencyScale[Math.min(days, 7)];
      }
        */

      function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.textContent = message;
        notification.style.display = "block";
        setTimeout(() => {
          notification.style.display = "none";
        }, 3000);
      }

      document
        .getElementById("searchInput")
        .addEventListener("input", updateTable);
      document
        .getElementById("filterSubject")
        .addEventListener("change", updateTable);

      function fetchRandomQuote() {
        const quotes = [
          "To infinity and beyond!",
          "Success usually comes to those who are too busy to be looking for it.",
          "Your limitation—it's only your imagination.",
          "Sometimes later becomes never. Do it now.",
          "The only way to do great work is to love what you do.",
          "Dream it. Wish it. Do it.",
          "Success is not for the lazy.",
          "The key to success is to start before you are ready.",
          "Dream big and dare to fail.",
          "Don’t wait for opportunity. Create it.",
        ];
        return quotes[Math.floor(Math.random() * quotes.length)];
      }

      function displayRandomQuote() {
        const quoteSection = document.getElementById("quoteSection");
        const randomQuote = fetchRandomQuote();
        quoteSection.textContent = `"${randomQuote}"`;
      }

      function updateProgress() {
        const progressBars = document.querySelectorAll(".progress-bar");
        const chapters = JSON.parse(localStorage.getItem("chapters")) || {};
        const totalChapters = Object.keys(chapters).length;
        if (totalChapters === 0) return;

        progressBars.forEach((bar) => {
          const subject = bar.dataset.subject;
          const subjectChapters = Object.values(chapters).filter(
            (chapter) => chapter.subject === subject
          ).length;
          const percentage = (subjectChapters / totalChapters) * 100;
          bar.querySelector(".progress").style.width = `${percentage}%`;
        });
      }

      window.onload = function () {
        displayRandomQuote();
        updateTable();
        updateProgress();
      };
    </script>
  </body>
</html>
